<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ramadhan Planner 2024</title>
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
  <style>
  body {
  background: #28a745 url('https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi896QyGRa9OLqNvsZHjRo0cI4UfBWi_NO3Ydo8f3QLCx1sBcOR4PGJDRa-f9XQ4d6naDBBnsMxqel7tIhILdAi4H9O76McX81ujkNGHaG_HBeueyasjPEdJNnxuQJP2oKLlnHYsM5CFnQRUQEF9NmDRtx-eXNWlqsseN-AqI7aDbhV-4YKgKNBtQulKZvR/s1600/_9d3f7b92-e6ff-4971-a1a8-896088680c45-transformed.jpeg') center;
  background-size: cover;
  font-family: 'Roboto', sans-serif;
  margin: 0;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
}

/* Container Styles */
.container {
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.8) 100%);
}

/* Heading Styles */
h2 {
  color: #007bff;
}

label {
  font-size: 18px;
  color: #333;
}

.form-check-label {
  font-size: 16px;
  color: #333;
}

/* Button Styles */
.btn-primary,
.btn-danger,
.btn-whatsapp,
.btn-export,
.btn-import {
  width: 100%;
  margin-top: 10px;
  padding: 15px;
  border: none;
  cursor: pointer;
  transition: background-color 0.3s ease;
  box-sizing: border-box;
  border-radius: 10px;
  display: block;
  text-align: center;
}

.btn-primary {
  background-color: #007bff;
  color: #fff;
}

.btn-danger {
  background-color: #dc3545;
  color: #fff;
}

.btn-whatsapp {
  background-color: #25d366;
  color: #fff;
}

.btn-export {
  background-color: #28a745;
  color: #fff;
}

.btn-import {
  background-color: #007bff;
  color: #fff;
}

/* Planner Item Styles */
.planner-item {
  margin-bottom: 20px;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  background: linear-gradient(180deg, rgba(248, 248, 248, 0.95) 0%, rgba(248, 248, 248, 0.9) 100%);
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

.planner-item strong {
  font-size: 18px;
  color: #333;
  display: block;
  margin-bottom: 10px;
}

.planner-details {
  font-size: 16px;
  color: #555;
  margin-bottom: 15px;
}

.planner-item hr {
  margin-top: 15px;
  margin-bottom: 5px;
  border-color: #ddd;
}

.planner-item .buttons-container {
  display: flex;
  justify-content: space-between;
  width: 100%;
  margin-top: 10px;
}

.planner-item .btn-whatsapp,
.planner-item .btn-danger {
  width: 100%;
}

/* Hover Effect */
.btn-primary:hover,
.btn-danger:hover,
.planner-item button.delete-btn:hover,
.btn-whatsapp:hover,
.btn-export:hover,
.btn-import:hover {
  background-color: darken(currentColor, 10%);
}

/* Navigation Drawer Styles */
.sidenav {
  height: 100%;
  width: 0;
  position: fixed;
  z-index: 1;
  top: 0;
  left: 0;
  background-color: #fff;
  overflow-x: hidden;
  transition: 0.5s;
  padding-top: 60px;
}

.sidenav a {
  padding: 8px 8px 8px 32px;
  text-decoration: none;
  font-size: 18px;
  color: #333;
  display: block;
  transition: 0.3s;
}

.sidenav a:hover {
  color: #007bff;
}

.sidenav .closebtn {
  position: absolute;
  top: 0;
  right: 25px;
  font-size: 36px;
  margin-left: 50px;
}

#main {
  transition: margin-left .5s;
  padding: 16px;
}

/* Header Styles */
.header {
  background-color: #28a745;
  padding: 15px;
  text-align: center;
  color: #fff;
}

.header img {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  margin-right: 10px;
}

.header h4 {
  margin-bottom: 5px;
}

.header p {
  font-size: 14px;
  margin: 0;
}

/* Hamburger Icon Styles */
    .hamburger-icon {
      font-size: 24px;
      cursor: pointer;
      color: #fff;
      position: absolute;
      top: 15px;
      left: 15px;
    }
.content-container {
  max-width: 80%;
  margin: 50px auto;
  padding: 30px;
  background-color: #fff;
  border-radius: 20px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  text-align: center;
  /* Tambahkan background image dan atur properti */
  background-image: url('https://st.depositphotos.com/2693151/60376/i/450/depositphotos_603760906-stock-photo-white-paper-wrinkled-texture-abstract.jpg');
  background-size: contain; /* Mengubah dari 'cover' menjadi 'contain' */
  background-position: center; /* Untuk mengatur posisi gambar di tengah */
}

.quote-container,
.hadith-container {
  margin-bottom: 30px;
}

.quote-text,
.hadith-text {
  font-size: 24px;
  line-height: 1.5;
  color: #333;
}

.author,
.hadith-reference {
  font-size: 18px;
  color: #666;
}

.owl-carousel .owl-item img {
  display: block;
  width: 100%;
  height: auto;
  border-radius: 20px;
}

.video-container {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 aspect ratio (lebar:tinggi) */
    height: 0;
    overflow: hidden;
}

.video-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

footer {
  background-color: #f8f9fa;
  padding: 50px 0;
}

footer h5 {
  margin-bottom: 20px;
  color: #333;
}

footer ul {
  padding: 0;
  list-style: none;
}

footer ul li {
  margin-bottom: 10px;
}

footer ul li a {
  color: #555;
  text-decoration: none;
  transition: color 0.3s ease;
}

footer ul li a:hover {
  color: #007bff;
}

@media (max-width: 768px) {
  footer ul li {
    margin-bottom: 15px;
  }
  footer ul li a {
    font-size: 14px;
  }
}


</style>


</head>
<body>
  <!-- Navigation Drawer -->
  <div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a href="tentang.html">Tentang Aplikasi</a>
    <a href="#">Beri Nilai Aplikasi</a>
    <a href="#">Privacy Policy</a>
  </div>

  <!-- Main Content -->
  <div id="main">
     <div class="header" onclick="openNav()">
      <i class="fas fa-bars"></i>
      <h4>Ramadhan Planner</h4>
      <p>Rencanakan Ibadahmu agar menjadi lebih baik</p>
    </div>
	</br>
	 <div class="container">
    <div class="owl-carousel owl-theme" id="content-slider"></div>
  </div>
  </br>
  
  <div class="container">
    <form id="ramadhanForm">
      <div class="form-group">
        <label for="date">Tanggal:</label>
        <input type="date" id="date" class="form-control" required>
      </div>
      <div class="form-group">
        <label for="name">Nama:</label>
        <input type="text" id="name" class="form-control" required>
      </div>
      <div class="form-group">
  <label for="whatsapp">Nomor WhatsApp:</label>
  <input type="text" id="whatsapp" class="form-control" pattern="[0-9]{13}" placeholder="Contoh: 6289570124429 atau 089570124429 " required>
</div>


      <h4>Sholat:</h4>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="subuh">
        <label class="form-check-label" for="subuh">Sholat Subuh</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="dzuhur">
        <label class="form-check-label" for="dzuhur">Sholat Dzuhur</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="ashar">
        <label class="form-check-label" for="ashar">Sholat Ashar</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="magrib">
        <label class="form-check-label" for="magrib">Sholat Magrib</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="isya">
        <label class="form-check-label" for="isya">Sholat Isya</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="tarawih">
        <label class="form-check-label" for="tarawih">Tarawih</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="witir">
        <label class="form-check-label" for="witir">Witir</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="tahajud">
        <label class="form-check-label" for="tahajud">Tahajud</label>
      </div>

      <h4>Juz Ayat dan Surah:</h4>

      <div class="form-group">
        <label for="juz">Juz:</label>
        <input type="text" id="juz" class="form-control">
      </div>

      <div class="form-group">
        <label for="surah">Surah:</label>
        <input type="text" id="surah" class="form-control">
      </div>

      <div class="form-group">
        <label for="ayat">Ayat:</label>
        <input type="text" id="ayat" class="form-control">
      </div>

      <h4>Dzikir dan Kebaikan:</h4>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="dzikirPagi">
        <label class="form-check-label" for="dzikirPagi">Dzikir Pagi</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="dzikirPetang">
        <label class="form-check-label" for="dzikirPetang">Dzikir Petang</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="sedekah">
        <label class="form-check-label" for="sedekah">Sedekah</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="bacaIstighfar">
        <label class="form-check-label" for="bacaIstighfar">Baca Istighfar</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="berbuatKebaikan">
        <label class="form-check-label" for="berbuatKebaikan">Berbuat Kebaikan</label>
      </div>

      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="membacaAlQuran">
        <label class="form-check-label" for="membacaAlQuran">Membaca Al-Quran</label>
      </div>

        <button type="button" class="btn btn-primary save-btn" onclick="saveData()">
  <i class="fas fa-save"></i> Simpan
</button>
	 </br>
<button type="button" class="btn btn-success export-btn" onclick="exportData()">
  <i class="fas fa-download"></i> Export Data
</button>
<button type="button" class="btn btn-info import-btn" onclick="importData()">
  <i class="fas fa-upload"></i> Import Data
</button>
<div class="clock text-center mb-4" id="clock"></div>
      <div id="jadwalSholat" class="mt-4"></div>
      <div id="countdown" class="text-center"></div>
      <button id="getJadwal" class="btn btn-primary btn-block mt-4">Tampilkan Jadwal Sholat</button>
<button type="button" class="btn btn-primary toggle-chart-btn" onclick="toggleCharts()">
  <i class="fas fa-chart-bar"></i>Tampil dan Tutup Grafik
</button>
<div class="chart-container" id="sholatChartContainer" style="display: none;">
  <canvas id="sholatChart" width="400" height="200"></canvas>
</div>
<div class="chart-container" id="juzAyatSurahChartContainer" style="display: none;">
  <canvas id="juzAyatSurahChart" width="400" height="200"></canvas>
</div>
<div class="chart-container" id="dzikirKebaikanChartContainer" style="display: none;">
  <canvas id="dzikirKebaikanChart" width="400" height="200"></canvas>
   
  </div>
    </form>
	 <div id="plannerList" class="mt-4">
      <!-- Daftar kegiatan yang telah disimpan -->
    </div>
	
	
	
	<footer>
	
	<div class="container">
      <!-- Application Description -->
      <div class="jumbotron">
        <h1 class="display-4">Aplikasi Ramadhan Planner</h1>
        <p class="lead">Merencanakan Ibadah Ramadhan dengan Lebih Mudah</p>
        <hr class="my-4">
        <p>Aplikasi Ramadhan Planner adalah alat praktis yang dirancang untuk membantu umat Muslim merencanakan dan melacak ibadah mereka selama bulan Ramadhan. Dengan fitur-fitur yang intuitif dan mudah digunakan, aplikasi ini memungkinkan pengguna untuk mencatat berbagai kegiatan ibadah seperti sholat, dzikir, sedekah, membaca Al-Quran, dan banyak lagi. Dengan demikian, pengguna dapat mengatur jadwal ibadah mereka dengan lebih efisien dan efektif.</p>
		<p>Dibuat Oleh Khairil Hakiki A.Md </p>
      </div>
	  
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <ul class="list-unstyled">
          <li><a href="#">Privacy Policy</a></li>
        </ul>
      </div>
      <div class="col-md-6 text-md-right">
        <ul class="list-unstyled">
          <li><a href="#">Download Aplikasi</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>

<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>

var swiper = new Swiper('.swiper-container', {
    slidesPerView: 'auto',
    centeredSlides: true,
    loop: true,
    pagination: {
      el: '.swiper-pagination',
    },
  });
// Function to check internet connection
function checkInternetConnection() {
    const img = document.createElement('img');
    img.src = 'https://www.google.com/images/phd/px.gif'; // Google's tiny transparent image
    img.onload = () => {
        // Internet connection is active
        console.log('Internet connection is active');
    };
    img.onerror = () => {
        // Internet connection is not active
        alert('Koneksi internet tidak aktif. Silakan periksa koneksi Anda.');
    };
}

// Call the function to check internet connection when the page loads
document.addEventListener('DOMContentLoaded', checkInternetConnection);

function openNav() {
      document.getElementById("mySidenav").style.width = "250px";
      document.getElementById("main").style.marginLeft = "250px";
    }

    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
      document.getElementById("main").style.marginLeft= "0";
    }
	
function getHistory(type) {
    const plannerData = JSON.parse(localStorage.getItem('plannerData')) || [];
    const history = new Set();

    plannerData.forEach(item => {
        if (type === 'name') {
            history.add(item.name);
        } else if (type === 'whatsapp') {
            history.add(item.whatsapp);
        }
    });

    return Array.from(history);
}

function showHistory(type) {
    const inputElement = document.getElementById(type);
    const history = getHistory(type);

    inputElement.setAttribute('list', `${type}-history`);

    const dataList = document.createElement('datalist');
    dataList.id = `${type}-history`;

    history.forEach(item => {
        const option = document.createElement('option');
        option.value = item;
        dataList.appendChild(option);
    });

    inputElement.parentNode.appendChild(dataList);
}

document.getElementById('name').addEventListener('focus', () => showHistory('name'));
document.getElementById('whatsapp').addEventListener('focus', () => showHistory('whatsapp'));

function saveData() {
    const rawDate = document.getElementById('date').value;
    const date = new Date(rawDate).toLocaleDateString('id-ID');

    const name = document.getElementById('name').value;
    const whatsapp = document.getElementById('whatsapp').value;
    const subuh = document.getElementById('subuh').checked;
    const dzuhur = document.getElementById('dzuhur').checked;
    const ashar = document.getElementById('ashar').checked;
    const magrib = document.getElementById('magrib').checked;
    const isya = document.getElementById('isya').checked;
    const tarawih = document.getElementById('tarawih').checked;
    const witir = document.getElementById('witir').checked;
    const tahajud = document.getElementById('tahajud').checked;
    const juz = document.getElementById('juz').value;
    const surah = document.getElementById('surah').value;
    const ayat = document.getElementById('ayat').value;
    const dzikirPagi = document.getElementById('dzikirPagi').checked;
    const dzikirPetang = document.getElementById('dzikirPetang').checked;
    const sedekah = document.getElementById('sedekah').checked;
    const bacaIstighfar = document.getElementById('bacaIstighfar').checked;
    const berbuatKebaikan = document.getElementById('berbuatKebaikan').checked;
    const membacaAlQuran = document.getElementById('membacaAlQuran').checked;

    // Check if mandatory fields are filled
    if (!rawDate || !name || !whatsapp) { // Additional check for rawDate
        alert('Tanggal, Nama, dan Nomor WhatsApp wajib diisi!');
        return;
    }

    const data = {
        date: date,
        name: name,
        whatsapp: whatsapp,
        subuh: subuh,
        dzuhur: dzuhur,
        ashar: ashar,
        magrib: magrib,
        isya: isya,
        tarawih: tarawih,
        witir: witir,
        tahajud: tahajud,
        juz: juz,
        surah: surah,
        ayat: ayat,
        dzikirPagi: dzikirPagi,
        dzikirPetang: dzikirPetang,
        sedekah: sedekah,
        bacaIstighfar: bacaIstighfar,
        berbuatKebaikan: berbuatKebaikan,
        membacaAlQuran: membacaAlQuran,
    };

    let plannerData = JSON.parse(localStorage.getItem('plannerData')) || [];
    plannerData.push(data);
    plannerData.sort((a, b) => new Date(b.date) - new Date(a.date));
    localStorage.setItem('plannerData', JSON.stringify(plannerData));

    let nameHistory = JSON.parse(localStorage.getItem('nameHistory')) || [];
    let whatsappHistory = JSON.parse(localStorage.getItem('whatsappHistory')) || [];

    nameHistory.unshift(name);
    whatsappHistory.unshift(whatsapp);

    nameHistory = Array.from(new Set(nameHistory));
    whatsappHistory = Array.from(new Set(whatsappHistory));

    localStorage.setItem('nameHistory', JSON.stringify(nameHistory.slice(0, 5)));
    localStorage.setItem('whatsappHistory', JSON.stringify(whatsappHistory.slice(0, 5)));

    displayPlanner(); // Menampilkan data setelah penyimpanan
    location.reload(); // Me-refresh halaman setelah penyimpanan data
}


function deleteData(index) {
    let plannerData = JSON.parse(localStorage.getItem('plannerData')) || [];
    
    // Mendapatkan indeks yang sesuai berdasarkan urutan tampilan
    let displayIndex = plannerData.length - 1 - index;

    if (displayIndex >= 0 && displayIndex < plannerData.length) {
        plannerData.splice(displayIndex, 1);
        localStorage.setItem('plannerData', JSON.stringify(plannerData));
        displayPlanner(); // Menampilkan data setelah penghapusan

        // Refresh halaman
        location.reload();
    } else {
        console.error('Indeks data tidak valid.');
    }
}



function sendToWhatsApp(index) {
    let plannerData = JSON.parse(localStorage.getItem('plannerData')) || [];
    let selectedData = plannerData[index];

    // Check if the WhatsApp number is provided
    if (!selectedData.whatsapp) {
        alert('Nomor WhatsApp wajib diisi!');
        return;
    }

    // Extracting the phone number from input
    let phoneNumber = selectedData.whatsapp.replace(/^0/, '62'); // convert '0895701244428' to '62895701244428'

    let message = `Ramadhan Planner\nNama: ${selectedData.name}\nTanggal: ${selectedData.date}\n\n`;
    message += `Sholat\n`;
    message += `Subuh: ${selectedData.subuh ? '✅' : '❌'}\n`;
    message += `Dzuhur: ${selectedData.dzuhur ? '✅' : '❌'}\n`;
    message += `Ashar: ${selectedData.ashar ? '✅' : '❌'}\n`;
    message += `Magrib: ${selectedData.magrib ? '✅' : '❌'}\n`;
    message += `Isya: ${selectedData.isya ? '✅' : '❌'}\n`;
    message += `Tarawih: ${selectedData.tarawih ? '✅' : '❌'}\n`;
    message += `Witir: ${selectedData.witir ? '✅' : '❌'}\n`;
    message += `Tahajud: ${selectedData.tahajud ? '✅' : '❌'}\n\n`;

    message += `Juz Ayat dan Surah\n`;
    message += `Juz: ${selectedData.juz || '-'}\n`;
    message += `Surah: ${selectedData.surah || '-'}\n`;
    message += `Ayat: ${selectedData.ayat || '-'}\n\n`;

    message += `Dzikir dan Kebaikan\n`;
    message += `Dzikir Pagi: ${selectedData.dzikirPagi ? '✅' : '❌'}\n`;
    message += `Dzikir Petang: ${selectedData.dzikirPetang ? '✅' : '❌'}\n`;
    message += `Sedekah: ${selectedData.sedekah ? '✅' : '❌'}\n`;
    message += `Baca Istighfar: ${selectedData.bacaIstighfar ? '✅' : '❌'}\n`;
    message += `Berbuat Kebaikan: ${selectedData.berbuatKebaikan ? '✅' : '❌'}\n`;
    message += `Membaca Al-Quran: ${selectedData.membacaAlQuran ? '✅' : '❌'}\n\n`;
    message += `Pelaporan ini menggunakan aplikasi Ramadhan Planner https://play.google.com/store/apps/details?id=com.ramdhan.planner`;

    let whatsappUrl = `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${encodeURIComponent(message)}`;
    window.open(whatsappUrl, '_blank');
}


// Function to export data as a JSON file
function exportData() {
    const plannerData = JSON.parse(localStorage.getItem('plannerData')) || [];
    const dataToExport = JSON.stringify(plannerData);

    const blob = new Blob([dataToExport], { type: 'application/json' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'Data Ramadhan Planner.json';
    link.click();
}

// Function to import data from a JSON file
function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';

    input.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const importedData = JSON.parse(e.target.result);
                localStorage.setItem('plannerData', JSON.stringify(importedData));
                displayPlanner();
                location.reload(); // Menyegarkan halaman setelah mengimpor data
            };
            reader.readAsText(file);
        }
    });

    input.click();
}

function toggleCharts() {
    const chartContainers = document.querySelectorAll('.chart-container');

    chartContainers.forEach(container => {
        container.style.display = container.style.display === 'none' ? 'block' : 'none';
    });
}

function updateChart() {
    const plannerData = JSON.parse(localStorage.getItem('plannerData')) || [];
    
    const juzAyatSurahCompletionCounts = plannerData.map(item => {
        const completionCount = (item.juz && item.surah && item.ayat) ? 1 : 0;
        return completionCount;
    });

    const ctxJuzAyatSurah = document.getElementById('juzAyatSurahChart').getContext('2d');
    const juzAyatSurahChart = new Chart(ctxJuzAyatSurah, {
        type: 'bar',
        data: {
            labels: ['Juz Ayat dan Surah'],
            datasets: [{
                label: 'Jumlah Dilakukan',
                data: juzAyatSurahCompletionCounts,
                backgroundColor: 'rgba(255, 205, 86, 0.2)',
                borderColor: 'rgba(255, 205, 86, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: Math.max(...juzAyatSurahCompletionCounts) + 1
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: 'Grafik Juz Ayat dan Surah'
                }
            }
        }
    });

    const sholatActivities = ['subuh', 'dzuhur', 'ashar', 'magrib', 'isya', 'tarawih', 'witir', 'tahajud'];
    const dzikirKebaikanActivities = ['dzikirPagi', 'dzikirPetang', 'sedekah', 'bacaIstighfar', 'berbuatKebaikan', 'membacaAlQuran'];

    const sholatCompletionCounts = sholatActivities.map(activity => {
        const completionCount = plannerData.filter(item => item[activity]).length;
        return completionCount;
    });

    const dzikirKebaikanCompletionCounts = dzikirKebaikanActivities.map(activity => {
        const completionCount = plannerData.filter(item => item[activity]).length;
        return completionCount;
    });

    const ctxSholat = document.getElementById('sholatChart').getContext('2d');
    const sholatChart = new Chart(ctxSholat, {
        type: 'bar',
        data: {
            labels: sholatActivities.map(activity => activity.replace(/[A-Z]/g, ' $&')),
            datasets: [{
                label: 'Jumlah Dilakukan',
                data: sholatCompletionCounts,
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: Math.max(...sholatCompletionCounts) + 1
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: 'Grafik Sholat'
                }
            }
        }
    });

    const ctxDzikirKebaikan = document.getElementById('dzikirKebaikanChart').getContext('2d');
    const dzikirKebaikanChart = new Chart(ctxDzikirKebaikan, {
        type: 'bar',
        data: {
            labels: dzikirKebaikanActivities.map(activity => activity.replace(/[A-Z]/g, ' $&')),
            datasets: [{
                label: 'Jumlah Dilakukan',
                data: dzikirKebaikanCompletionCounts,
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: Math.max(...dzikirKebaikanCompletionCounts) + 1
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: 'Grafik Dzikir dan Kebaikan'
                }
            }
        }
    });
}

// Call updateChart() when the page loads and after saving/deleting data
document.addEventListener('DOMContentLoaded', () => {
    updateChart();
});

 document.getElementById('getJadwal').addEventListener('click', function() {
    getLocation();
  });

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition, showError);
    } else {
      alert("Geolocation tidak didukung oleh browser Anda.");
    }
  }

  function showPosition(position) {
    var latitude = position.coords.latitude;
    var longitude = position.coords.longitude;
    getPrayerTimes(latitude, longitude);
  }

  function showError(error) {
    switch(error.code) {
      case error.PERMISSION_DENIED:
        alert("Akses lokasi ditolak oleh pengguna.");
        break;
      case error.POSITION_UNAVAILABLE:
        alert("Informasi lokasi tidak tersedia.");
        break;
      case error.TIMEOUT:
        alert("Waktu permintaan lokasi telah habis.");
        break;
      case error.UNKNOWN_ERROR:
        alert("Terjadi kesalahan yang tidak diketahui.");
        break;
    }
  }

  function getPrayerTimes(latitude, longitude) {
    fetch(`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=2`)
      .then(response => response.json())
      .then(data => {
        var today = new Date();
        var date = today.getDate();
        var month = today.getMonth() + 1;
        var year = today.getFullYear();
        var prayerTimes = data.data[date - 1].timings;

        // Tampilkan jadwal sholat
        document.getElementById('jadwalSholat').innerHTML = `
          <h4>Jadwal Sholat Hari Ini:</h4>
          <ul>
            <li>Subuh: ${prayerTimes.Fajr}</li>
            <li>Dzuhur: ${prayerTimes.Dhuhr}</li>
            <li>Ashar: ${prayerTimes.Asr}</li>
            <li>Maghrib: ${prayerTimes.Maghrib}</li>
            <li>Isya: ${prayerTimes.Isha}</li>
          </ul>
        `;

        // Hitung mundur menuju waktu sholat berikutnya
        var currentTime = today.getHours() * 3600 + today.getMinutes() * 60 + today.getSeconds();
        var nextPrayerTime;
        var nextPrayerName;
        if (currentTime < parseTime(prayerTimes.Fajr)) {
          nextPrayerTime = parseTime(prayerTimes.Fajr);
          nextPrayerName = "Subuh";
        } else if (currentTime < parseTime(prayerTimes.Dhuhr)) {
          nextPrayerTime = parseTime(prayerTimes.Dhuhr);
          nextPrayerName = "Dzuhur";
        } else if (currentTime < parseTime(prayerTimes.Asr)) {
          nextPrayerTime = parseTime(prayerTimes.Asr);
          nextPrayerName = "Ashar";
        } else if (currentTime < parseTime(prayerTimes.Maghrib)) {
          nextPrayerTime = parseTime(prayerTimes.Maghrib);
          nextPrayerName = "Maghrib";
        } else if (currentTime < parseTime(prayerTimes.Isha)) {
          nextPrayerTime = parseTime(prayerTimes.Isha);
          nextPrayerName = "Isya";
        } else {
          nextPrayerTime = parseTime(prayerTimes.Fajr) + 86400; // Jika sudah lewat waktu Isya, hitung untuk Shubuh besok
          nextPrayerName = "Subuh";
        }
        
        var countdownSeconds = nextPrayerTime - currentTime;
        var hours = Math.floor(countdownSeconds / 3600);
        var minutes = Math.floor((countdownSeconds % 3600) / 60);
        var seconds = countdownSeconds % 60;

        document.getElementById('countdown').innerHTML = `
          <h4>Hitung Mundur Menuju ${nextPrayerName}:</h4>
          <div id="timer">${hours} Jam ${minutes} Menit ${seconds} Detik</div>
        `;

        // Perbarui hitung mundur setiap detik
        setInterval(function() {
          countdownSeconds--;
          hours = Math.floor(countdownSeconds / 3600);
          minutes = Math.floor((countdownSeconds % 3600) / 60);
          seconds = countdownSeconds % 60;
          document.getElementById('timer').innerHTML = `${hours} Jam ${minutes} Menit ${seconds} Detik`;
        }, 1000);
      })
      .catch(error => {
        console.error('Error:', error);
        alert("Terjadi kesalahan dalam mendapatkan jadwal sholat.");
      });
  }

  function parseTime(timeString) {
    var time = timeString.split(':');
    return parseInt(time[0]) * 3600 + parseInt(time[1]) * 60;
  }



function displayPlanner() {
    const plannerList = document.getElementById('plannerList');
    plannerList.innerHTML = '';

    let plannerData = JSON.parse(localStorage.getItem('plannerData')) || [];

    // Sort plannerData based on date in descending order
    plannerData.sort((a, b) => new Date(b.date) - new Date(a.date));

    // Reverse the plannerData array so that the newest data appears first
    plannerData.reverse();

    plannerData.forEach((item, index) => {
        const listItem = document.createElement('div');
        listItem.classList.add('planner-item');
        listItem.innerHTML = `
            <strong>${item.name}</strong><br>
            Tanggal: ${item.date}<br><br>
            Sholat<br>
            Sholat Subuh: ${item.subuh ? '✅' : '❌'}
            Sholat Dzuhur: ${item.dzuhur ? '✅' : '❌'}
            Sholat Ashar: ${item.ashar ? '✅' : '❌'}
            Sholat Magrib: ${item.magrib ? '✅' : '❌'}
            Sholat Isya: ${item.isya ? '✅' : '❌'}<br>
            Tarawih: ${item.tarawih ? '✅' : '❌'}
            Witir: ${item.witir ? '✅' : '❌'}
            Tahajud: ${item.tahajud ? '✅' : '❌'}<br><br>
            Juz Ayat dan Surah<br>
            Juz: ${item.juz || '-'}
            Surah: ${item.surah || '-'}
            Ayat: ${item.ayat || '-'}<br><br>
            Dzikir dan Kebaikan<br>
            Dzikir Pagi: ${item.dzikirPagi ? '✅' : '❌'}
            Dzikir Petang: ${item.dzikirPetang ? '✅' : '❌'}
            Sedekah: ${item.sedekah ? '✅' : '❌'}
            Baca Istighfar: ${item.bacaIstighfar ? '✅' : '❌'}
            Berbuat Kebaikan: ${item.berbuatKebaikan ? '✅' : '❌'}
            Membaca Al-Quran: ${item.membacaAlQuran ? '✅' : '❌'}<br>
            <button type="button" class="btn btn-whatsapp" onclick="sendToWhatsApp(${index})">
                <i class="fab fa-whatsapp"></i> Kirim ke WhatsApp
            </button>
            <button type="button" class="btn btn-danger" onclick="deleteData(${index})">
                <i class="fas fa-trash"></i> Hapus
            </button>
            <hr>
        `;
        plannerList.appendChild(listItem);
    });
}





displayPlanner();
</script>



  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
  <script src="script.js" defer></script>
</body>
</html>
